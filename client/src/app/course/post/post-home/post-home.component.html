<div class="container">
  <div class="container" style="margin-top: 2%;">
    <div class="row">
      <div class="column">
        <h1>{{questionRoot.title}}</h1>
        <p> Asked <b>{{getDaysAgo(questionRoot.postDate)}}</b> &nbsp;&nbsp;&nbsp;Viewed
          <b>{{questionRoot.viewCount}}</b>
          times</p>
      </div>
    </div>

    <div class="row" style="border-top: solid 1pt black; padding-top: 3%;">
      <div class="col-xs-2 align-content-center">
        <div class="row text-center">
          <div class="col">
            <p *ngIf="questionRoot.likeCount != 0">{{questionRoot.likeCount}}</p>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div *ngIf="questionRoot.likesUserIDMap[user.email] != 1"
                 class="btn-xs btn-outline-primary text-center" (click)="like(questionRoot.id, 1)">Up
            </div>
            <div *ngIf="questionRoot.likesUserIDMap[user.email] === 1"
                 class="btn-xs btn-primary text-center" (click)="like(questionRoot.id, 0)">Up
            </div>
            <div *ngIf="questionRoot.likesUserIDMap[user.email] != -1"
                 class="btn-xs btn-outline-danger text-center" (click)="like(questionRoot.id, -1)">Dn
            </div>
            <div *ngIf="questionRoot.likesUserIDMap[user.email] === -1"
                 class="btn-xs btn-danger text-center" (click)="like(questionRoot.id, 0)">Dn
            </div>
          </div>
        </div>
      </div>

      <div class="col" style="margin-left: 1%">
        <div [innerHTML]="questionRoot.content"></div>
        <div>
          <div *ngIf="questionRoot.folder != null">
            <br>
            <br>
            <p>Folder:</p>
            <button class="btn btn-outline-success" >{{questionRoot.folder}}</button>
          </div>
          <br>
        </div>
      </div>
    </div>
    <div class="container">
      <p style="text-align: right"><b>{{questionRoot.authorName}}</b> <b *ngIf="questionRoot.authorType === 'INSTRUCTOR'" style="color: green"> (Instructor)</b> on
        {{getDate(questionRoot.postDate)}}</p>
    </div>
  </div>
  <br>
  <br>

  <div class="container" *ngIf="questionRoot.questionRootAnswerList.length != 0">
    <h3 class="text-success">{{questionRoot.questionRootAnswerList.length}} ANSWERS</h3>
    <div class="container">
      <div *ngFor="let qra of questionRoot.questionRootAnswerList">
        <div class="row" style="border-top: solid 1pt black; padding-top: 1%">
          <div class="col-xs-2 text-center">
            <p *ngIf="qra.likeCount != 0">{{qra.likeCount}}</p>
            <div class="row">
              <div class="col">
                <div *ngIf="qra.likesUserIDMap[user.email] != 1"
                     class="btn-xs btn-outline-primary text-center" (click)="like(qra.id, 1)">Up
                </div>
                <div *ngIf="qra.likesUserIDMap[user.email] === 1"
                     class="btn-xs btn-primary text-center" (click)="like(qra.id, 0)">Up
                </div>
                <div *ngIf="qra.likesUserIDMap[user.email] != -1"
                     class="btn-xs btn-outline-danger text-center" (click)="like(qra.id, -1)">Dn
                </div>
                <div *ngIf="qra.likesUserIDMap[user.email] === -1"
                     class="btn-xs btn-danger text-center" (click)="like(qra.id, 0)">Dn
                </div>
              </div>
            </div>
          </div>
          <div class="col">
            <div [innerHTML]="qra.content"></div>
            <div style="text-align: right">
              <p style="text-align: right"><b>{{qra.authorName}}</b> <b *ngIf="qra.authorType === 'INSTRUCTOR'" style="color: green"> (Instructor)</b> on  {{getDate(qra.postDate)}}</p>
            </div>
          </div>
          <hr>
        </div>


        <div class="row" style="border-top: solid 1pt lightgray; padding-top: 3%; margin-left: 3%; padding-left: 1%"
             *ngFor="let qrar of qra.questionRootAnswerReplyList">
          <div class="col-xs-4">
            <div class="col-xs-2 text-center">
              <p *ngIf="qrar.likeCount != 0">{{qrar.likeCount}}</p>
              <div class="row">
                <div class="col">
                  <div *ngIf="qrar.likesUserIDMap[user.email] != 1"
                       class="btn-xs btn-outline-primary text-center" (click)="like(qrar.id, 1)">Up
                  </div>
                  <div *ngIf="qrar.likesUserIDMap[user.email] === 1"
                       class="btn-xs btn-primary text-center" (click)="like(qrar.id, 0)">Up
                  </div>
                  <div *ngIf="qrar.likesUserIDMap[user.email] != -1"
                       class="btn-xs btn-outline-danger text-center" (click)="like(qrar.id, -1)">Dn
                  </div>
                  <div *ngIf="qrar.likesUserIDMap[user.email] === -1"
                       class="btn-xs btn-danger text-center" (click)="like(qrar.id, 0)">Dn
                  </div>
                </div>
              </div>
            </div>
          </div>
          <hr>
          <div class="col">
            <div [innerHTML]="qrar.content"></div>
            <div>
              <p style="text-align: right"><b>{{qrar.authorName}}</b> <b *ngIf="qrar.authorType === 'INSTRUCTOR'" style="color: green"> (Instructor)</b> on  {{getDate(qrar.postDate)}}</p>
            </div>
          </div>
          <hr>
        </div>
        <div style="margin-left: 3%;">
          <p *ngIf="!this.kv.get(qra.id)" (click)="toggleEditor(qra.id)" class="text-primary">Add a reply <br></p>
          <app-editor *ngIf="this.kv.get(qra.id)" type="QUESTIONROOTANSWERREPLY" [parentId]="qra.id"
                      [courseId]="courseId"
                      [questionRootId]="questionRoot.id"></app-editor>
          <br>
          <p *ngIf="this.kv.get(qra.id)" (click)="toggleEditor(qra.id)" class="text-primary">Cancel</p>
        </div>
      </div>
    </div>
  </div>


  <div class="container" style="margin-top: 1%; border: white solid 1pt" *ngIf="showAddAnswerEditor">
    <hr>
    <h4>Your answer</h4>
    <br>
    <app-editor [parentId]="questionRoot.id" type="QUESTIONROOTANSWER" [courseId]="courseId"
                [questionRootId]="questionRoot.id"></app-editor>
  </div>
  <div class="container">
    <button *ngIf="!showAddAnswerEditor" class="btn btn-primary" type="button"
            (click)="showAddAnswerEditor = !showAddAnswerEditor"> Add an answer
    </button>
    <p *ngIf="showAddAnswerEditor" class="text-primary" style="margin-left: 2px; margin-top: 5px"
       (click)="showAddAnswerEditor = !showAddAnswerEditor">Cancel
    </p>
  </div>
  <br>


  <div class="container" style="margin-top: 1%; border: white solid 1pt"
       *ngIf="questionRoot.followupQuestionList.length != 0">
    <hr>
    <h3 class="text-danger">{{questionRoot.followupQuestionList.length}} FOLLOWUPS</h3>
    <hr>
    <div *ngFor="let fq of questionRoot.followupQuestionList">
      <p [innerHTML]="fq.content"></p>
      <p style="text-align: right"><b>{{fq.authorName}}</b> <b *ngIf="fq.authorType === 'INSTRUCTOR'" style="color: green"> (Instructor)</b> on  {{getDate(fq.postDate)}}</p>
      <hr>
      <div style="margin-left: 2%" *ngFor="let fa of fq.followupAnswerList">
        <div [innerHTML]="fa.content"></div>
        <p style="text-align: right"><b>{{fa.authorName}}</b> <b *ngIf="fa.authorType === 'INSTRUCTOR'" style="color: green"> (Instructor)</b> on  {{getDate(fa.postDate)}}</p>
        <hr>
      </div>

      <div style="margin-left: 2%;">
        <p *ngIf="!this.kv.get(fq.id)" (click)="toggleEditor(fq.id)" class="text-primary">Add a reply <br></p>
        <app-editor *ngIf="this.kv.get(fq.id)" type="FOLLOWUPANSWER" [parentId]="fq.id" [courseId]="courseId"
                    [questionRootId]="questionRoot.id"></app-editor>
        <br>
        <p *ngIf="this.kv.get(fq.id)" (click)="toggleEditor(fq.id)" class="text-primary">Cancel</p>
      </div>
      <br>
    </div>
  </div>


  <div class="container" style="margin-top: 1%; border: white solid 1pt" *ngIf="!showAddAnswerEditor">
    <hr>
    <h4>Ask a follow up question</h4><br>
    <app-editor [parentId]="questionRoot.id" type="FOLLOWUPQUESTION" [courseId]="courseId"
                [questionRootId]="questionRoot.id"></app-editor>
  </div>
  <div class="container">
    <button *ngIf="showAddAnswerEditor" class="btn btn-primary" type="button" style="margin-right: 5px"
            (click)="showAddAnswerEditor = !showAddAnswerEditor"> Ask a follow up question
    </button>
    <br>
    <p *ngIf="!showAddAnswerEditor" class="text-primary" style="margin-right: 5px"
       (click)="showAddAnswerEditor = !showAddAnswerEditor">Cancel
    </p>
  </div>
  <br>
</div>
